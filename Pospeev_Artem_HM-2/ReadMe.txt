Доброго времени суток.

В этот раз посложнее было, конечно

1) Без комментариев.
2) Пришлось повозиться, чтобы понять. В целом - ок.
3) Очень много проверок для исключения бесконечных циклов. Работает, но чувствую, что решение "дурацкое"
4 и 5) Ощутимо лучше стал работать со срезами и выводом. Приятные задачи